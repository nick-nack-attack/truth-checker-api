function cov_2qec5toyj8(){var path="/Users/nickfarni/WebstormProjects/truth-checker-api/src/users/users-router.js";var hash="c7bed9a7eeb29a13cbdcf758814d60f01fba3e4b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/nickfarni/WebstormProjects/truth-checker-api/src/users/users-router.js",statementMap:{"0":{start:{line:2,column:26},end:{line:2,column:41}},"1":{start:{line:3,column:26},end:{line:3,column:44}},"2":{start:{line:4,column:26},end:{line:4,column:44}},"3":{start:{line:5,column:26},end:{line:5,column:59}},"4":{start:{line:6,column:26},end:{line:6,column:34}},"5":{start:{line:7,column:26},end:{line:7,column:40}},"6":{start:{line:10,column:26},end:{line:10,column:52}},"7":{start:{line:14,column:0},end:{line:76,column:7}},"8":{start:{line:19,column:8},end:{line:23,column:22}},"9":{start:{line:21,column:14},end:{line:21,column:67}},"10":{start:{line:29,column:34},end:{line:29,column:42}},"11":{start:{line:31,column:6},end:{line:37,column:15}},"12":{start:{line:32,column:8},end:{line:37,column:15}},"13":{start:{line:33,column:8},end:{line:37,column:15}},"14":{start:{line:39,column:30},end:{line:39,column:69}},"15":{start:{line:40,column:8},end:{line:46,column:9}},"16":{start:{line:41,column:12},end:{line:45,column:19}},"17":{start:{line:48,column:8},end:{line:75,column:21}},"18":{start:{line:50,column:10},end:{line:55,column:19}},"19":{start:{line:51,column:12},end:{line:55,column:19}},"20":{start:{line:57,column:10},end:{line:73,column:13}},"21":{start:{line:59,column:30},end:{line:64,column:15}},"22":{start:{line:66,column:14},end:{line:72,column:17}},"23":{start:{line:68,column:18},end:{line:71,column:62}},"24":{start:{line:77,column:4},end:{line:77,column:33}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:9},end:{line:16,column:10}},loc:{start:{line:16,column:29},end:{line:26,column:5}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:16},end:{line:20,column:17}},loc:{start:{line:20,column:33},end:{line:22,column:11}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:28,column:22},end:{line:28,column:23}},loc:{start:{line:28,column:42},end:{line:76,column:5}},line:28},"3":{name:"(anonymous_3)",decl:{start:{line:49,column:14},end:{line:49,column:15}},loc:{start:{line:49,column:36},end:{line:74,column:9}},line:49},"4":{name:"(anonymous_4)",decl:{start:{line:58,column:16},end:{line:58,column:17}},loc:{start:{line:58,column:36},end:{line:73,column:11}},line:58},"5":{name:"(anonymous_5)",decl:{start:{line:67,column:20},end:{line:67,column:21}},loc:{start:{line:67,column:30},end:{line:72,column:15}},line:67}},branchMap:{"0":{loc:{start:{line:32,column:8},end:{line:37,column:15}},type:"if",locations:[{start:{line:32,column:8},end:{line:37,column:15}},{start:{line:32,column:8},end:{line:37,column:15}}],line:32},"1":{loc:{start:{line:40,column:8},end:{line:46,column:9}},type:"if",locations:[{start:{line:40,column:8},end:{line:46,column:9}},{start:{line:40,column:8},end:{line:46,column:9}}],line:40},"2":{loc:{start:{line:50,column:10},end:{line:55,column:19}},type:"if",locations:[{start:{line:50,column:10},end:{line:55,column:19}},{start:{line:50,column:10},end:{line:55,column:19}}],line:50}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c7bed9a7eeb29a13cbdcf758814d60f01fba3e4b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2qec5toyj8=function(){return actualCoverage;};}return actualCoverage;}cov_2qec5toyj8();// Users Router
const path=(cov_2qec5toyj8().s[0]++,require('path'));const express=(cov_2qec5toyj8().s[1]++,require('express'));const{Router}=(cov_2qec5toyj8().s[2]++,require('express'));const{requireAuth}=(cov_2qec5toyj8().s[3]++,require('../middleware/jwt-auth'));const UsersRouter=(cov_2qec5toyj8().s[4]++,Router());const jsonParser=(cov_2qec5toyj8().s[5]++,express.json());// service
const UsersService=(cov_2qec5toyj8().s[6]++,require('./users-service'));// creating users currently not supported.
// for testing purposes
cov_2qec5toyj8().s[7]++;UsersRouter.route('/').get((req,res,next)=>{cov_2qec5toyj8().f[0]++;cov_2qec5toyj8().s[8]++;return UsersService.getAllUsers().then(listOfUsers=>{cov_2qec5toyj8().f[1]++;cov_2qec5toyj8().s[9]++;res.json(listOfUsers.map(UsersService.serializeUser));}).catch(next);}).post(jsonParser,(req,res,next)=>{cov_2qec5toyj8().f[2]++;const{email,password}=(cov_2qec5toyj8().s[10]++,req.body);cov_2qec5toyj8().s[11]++;for(const field of['email','password']){cov_2qec5toyj8().s[12]++;if(!req.body[field]){cov_2qec5toyj8().b[0][0]++;cov_2qec5toyj8().s[13]++;return res.status(400).json({error:`Missing ${field} in request body`});}else{cov_2qec5toyj8().b[0][1]++;}}const passwordError=(cov_2qec5toyj8().s[14]++,UsersService.validatePassword(password));cov_2qec5toyj8().s[15]++;if(passwordError){cov_2qec5toyj8().b[1][0]++;cov_2qec5toyj8().s[16]++;return res.status(400).json({error:passwordError});}else{cov_2qec5toyj8().b[1][1]++;}cov_2qec5toyj8().s[17]++;UsersService.hasUserWithEmail(email).then(hasUserWithEmail=>{cov_2qec5toyj8().f[3]++;cov_2qec5toyj8().s[18]++;if(hasUserWithEmail){cov_2qec5toyj8().b[2][0]++;cov_2qec5toyj8().s[19]++;return res.status(400).json({error:`Email already exists`});}else{cov_2qec5toyj8().b[2][1]++;}cov_2qec5toyj8().s[20]++;return UsersService.hashPassword(password).then(hashedPassword=>{cov_2qec5toyj8().f[4]++;const newUser=(cov_2qec5toyj8().s[21]++,{role:'End-User',email,password:hashedPassword,date_created:'now()'});cov_2qec5toyj8().s[22]++;return UsersService.insertUser(newUser).then(user=>{cov_2qec5toyj8().f[5]++;cov_2qec5toyj8().s[23]++;res.status(201).location(path.posix.join(req.originalUrl,`/${user.user_id}`)).json(UsersService.serializeUser(user));});});}).catch(next);});cov_2qec5toyj8().s[24]++;module.exports=UsersRouter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJzLXJvdXRlci5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImV4cHJlc3MiLCJSb3V0ZXIiLCJyZXF1aXJlQXV0aCIsIlVzZXJzUm91dGVyIiwianNvblBhcnNlciIsImpzb24iLCJVc2Vyc1NlcnZpY2UiLCJyb3V0ZSIsImdldCIsInJlcSIsInJlcyIsIm5leHQiLCJnZXRBbGxVc2VycyIsInRoZW4iLCJsaXN0T2ZVc2VycyIsIm1hcCIsInNlcmlhbGl6ZVVzZXIiLCJjYXRjaCIsInBvc3QiLCJlbWFpbCIsInBhc3N3b3JkIiwiYm9keSIsImZpZWxkIiwic3RhdHVzIiwiZXJyb3IiLCJwYXNzd29yZEVycm9yIiwidmFsaWRhdGVQYXNzd29yZCIsImhhc1VzZXJXaXRoRW1haWwiLCJoYXNoUGFzc3dvcmQiLCJoYXNoZWRQYXNzd29yZCIsIm5ld1VzZXIiLCJyb2xlIiwiZGF0ZV9jcmVhdGVkIiwiaW5zZXJ0VXNlciIsInVzZXIiLCJsb2NhdGlvbiIsInBvc2l4Iiwiam9pbiIsIm9yaWdpbmFsVXJsIiwidXNlcl9pZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJtcEhBZVk7MkZBZlo7QUFDQSxLQUFNQSxDQUFBQSxJQUFJLDBCQUFnQkMsT0FBTyxDQUFDLE1BQUQsQ0FBdkIsQ0FBVixDQUNBLEtBQU1DLENBQUFBLE9BQU8sMEJBQWFELE9BQU8sQ0FBQyxTQUFELENBQXBCLENBQWIsQ0FDQSxLQUFNLENBQUVFLE1BQUYsMkJBQW9CRixPQUFPLENBQUMsU0FBRCxDQUEzQixDQUFOLENBQ0EsS0FBTSxDQUFFRyxXQUFGLDJCQUFvQkgsT0FBTyxDQUFDLHdCQUFELENBQTNCLENBQU4sQ0FDQSxLQUFNSSxDQUFBQSxXQUFXLDBCQUFTRixNQUFNLEVBQWYsQ0FBakIsQ0FDQSxLQUFNRyxDQUFBQSxVQUFVLDBCQUFVSixPQUFPLENBQUNLLElBQVIsRUFBVixDQUFoQixDQUVBO0FBQ0EsS0FBTUMsQ0FBQUEsWUFBWSwwQkFBUVAsT0FBTyxDQUFDLGlCQUFELENBQWYsQ0FBbEIsQ0FFQTtBQUNBO3dCQUNBSSxXQUFXLENBQ05JLEtBREwsQ0FDVyxHQURYLEVBRUtDLEdBRkwsQ0FFUyxDQUFDQyxHQUFELENBQU1DLEdBQU4sQ0FBV0MsSUFBWCxHQUFvQixpREFHckIsTUFBT0wsQ0FBQUEsWUFBWSxDQUFDTSxXQUFiLEdBQ0pDLElBREksQ0FDRUMsV0FBRCxFQUFpQixpREFDbkJKLEdBQUcsQ0FBQ0wsSUFBSixDQUFTUyxXQUFXLENBQUNDLEdBQVosQ0FBZ0JULFlBQVksQ0FBQ1UsYUFBN0IsQ0FBVCxFQUNILENBSEksRUFJSkMsS0FKSSxDQUlFTixJQUpGLENBQVAsQ0FPSCxDQVpMLEVBY0tPLElBZEwsQ0FjVWQsVUFkVixDQWNzQixDQUFDSyxHQUFELENBQU1DLEdBQU4sQ0FBV0MsSUFBWCxHQUFvQix5QkFDcEMsS0FBTSxDQUFFUSxLQUFGLENBQVNDLFFBQVQsNEJBQXNCWCxHQUFHLENBQUNZLElBQTFCLENBQU4sQ0FEb0MseUJBR3BDLElBQUssS0FBTUMsQ0FBQUEsS0FBWCxHQUFvQixDQUFDLE9BQUQsQ0FBVSxVQUFWLENBQXBCLENBQ0UsNkJBQUksQ0FBQ2IsR0FBRyxDQUFDWSxJQUFKLENBQVNDLEtBQVQsQ0FBTCxDQUNBLDJEQUFPWixDQUFBQSxHQUFHLENBQ0xhLE1BREUsQ0FDSyxHQURMLEVBRUZsQixJQUZFLENBRUcsQ0FDRm1CLEtBQUssQ0FBRyxXQUFVRixLQUFNLGtCQUR0QixDQUZILENBQVAsQ0FJTyxDQUxQLGlDQUtPLENBRVAsS0FBTUcsQ0FBQUEsYUFBYSwyQkFBR25CLFlBQVksQ0FBQ29CLGdCQUFiLENBQThCTixRQUE5QixDQUFILENBQW5CLENBWGtDLHlCQVlsQyxHQUFJSyxhQUFKLENBQW1CLHFEQUNmLE1BQU9mLENBQUFBLEdBQUcsQ0FDTGEsTUFERSxDQUNLLEdBREwsRUFFRmxCLElBRkUsQ0FFRyxDQUNGbUIsS0FBSyxDQUFFQyxhQURMLENBRkgsQ0FBUCxDQUtILENBTkQsaUNBWmtDLHlCQW9CbENuQixZQUFZLENBQUNxQixnQkFBYixDQUE4QlIsS0FBOUIsRUFDQ04sSUFERCxDQUNPYyxnQkFBRCxFQUFzQixrREFDMUIsR0FBSUEsZ0JBQUosQ0FDRSwyREFBT2pCLENBQUFBLEdBQUcsQ0FDTGEsTUFERSxDQUNLLEdBREwsRUFFRmxCLElBRkUsQ0FFRyxDQUNGbUIsS0FBSyxDQUFHLHNCQUROLENBRkgsQ0FBUCxDQUlPLENBTFQsaUNBRDBCLHlCQVExQixNQUFPbEIsQ0FBQUEsWUFBWSxDQUFDc0IsWUFBYixDQUEwQlIsUUFBMUIsRUFDTlAsSUFETSxDQUNBZ0IsY0FBRCxFQUFvQix5QkFDdEIsS0FBTUMsQ0FBQUEsT0FBTywyQkFBRyxDQUNaQyxJQUFJLENBQUUsVUFETSxDQUVaWixLQUZZLENBR1pDLFFBQVEsQ0FBRVMsY0FIRSxDQUlaRyxZQUFZLENBQUUsT0FKRixDQUFILENBQWIsQ0FEc0IseUJBUXRCLE1BQU8xQixDQUFBQSxZQUFZLENBQUMyQixVQUFiLENBQXdCSCxPQUF4QixFQUNOakIsSUFETSxDQUNBcUIsSUFBRCxFQUFVLGtEQUNaeEIsR0FBRyxDQUNFYSxNQURMLENBQ1ksR0FEWixFQUVLWSxRQUZMLENBRWNyQyxJQUFJLENBQUNzQyxLQUFMLENBQVdDLElBQVgsQ0FBZ0I1QixHQUFHLENBQUM2QixXQUFwQixDQUFrQyxJQUFJSixJQUFJLENBQUNLLE9BQVMsRUFBcEQsQ0FGZCxFQUdLbEMsSUFITCxDQUdVQyxZQUFZLENBQUNVLGFBQWIsQ0FBMkJrQixJQUEzQixDQUhWLEVBSUgsQ0FOTSxDQUFQLENBT0gsQ0FoQk0sQ0FBUCxDQWlCRCxDQTFCRCxFQTJCQ2pCLEtBM0JELENBMkJPTixJQTNCUCxFQTRCSCxDQTlETCxFLHlCQStESTZCLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQnRDLFdBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVXNlcnMgUm91dGVyXG5jb25zdCBwYXRoICAgICAgICAgICAgICA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGV4cHJlc3MgICAgICAgICAgID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3QgeyBSb3V0ZXIgfSAgICAgICAgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCB7IHJlcXVpcmVBdXRoIH0gICA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvand0LWF1dGgnKTtcbmNvbnN0IFVzZXJzUm91dGVyICAgICAgID0gUm91dGVyKCk7XG5jb25zdCBqc29uUGFyc2VyICAgICAgICA9IGV4cHJlc3MuanNvbigpO1xuXG4vLyBzZXJ2aWNlXG5jb25zdCBVc2Vyc1NlcnZpY2UgICAgICA9IHJlcXVpcmUoJy4vdXNlcnMtc2VydmljZScpO1xuXG4vLyBjcmVhdGluZyB1c2VycyBjdXJyZW50bHkgbm90IHN1cHBvcnRlZC5cbi8vIGZvciB0ZXN0aW5nIHB1cnBvc2VzXG5Vc2Vyc1JvdXRlclxuICAgIC5yb3V0ZSgnLycpXG4gICAgLmdldCgocmVxLCByZXMsIG5leHQpID0+IHtcblxuXG4gICAgICAgIHJldHVybiBVc2Vyc1NlcnZpY2UuZ2V0QWxsVXNlcnMoKVxuICAgICAgICAgIC50aGVuKChsaXN0T2ZVc2VycykgPT4ge1xuICAgICAgICAgICAgICByZXMuanNvbihsaXN0T2ZVc2Vycy5tYXAoVXNlcnNTZXJ2aWNlLnNlcmlhbGl6ZVVzZXIpKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKG5leHQpXG5cblxuICAgIH0pXG5cbiAgICAucG9zdChqc29uUGFyc2VyLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcblxuICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiBbJ2VtYWlsJywgJ3Bhc3N3b3JkJ10pXG4gICAgICAgIGlmICghcmVxLmJvZHlbZmllbGRdKVxuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAgIC5qc29uKHtcbiAgICAgICAgICAgICAgICBlcnJvcjogYE1pc3NpbmcgJHtmaWVsZH0gaW4gcmVxdWVzdCBib2R5YFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcGFzc3dvcmRFcnJvciA9IFVzZXJzU2VydmljZS52YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkKTtcbiAgICAgICAgaWYgKHBhc3N3b3JkRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAgICAgICAuanNvbih7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBwYXNzd29yZEVycm9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBVc2Vyc1NlcnZpY2UuaGFzVXNlcldpdGhFbWFpbChlbWFpbClcbiAgICAgICAgLnRoZW4oKGhhc1VzZXJXaXRoRW1haWwpID0+IHtcbiAgICAgICAgICBpZiAoaGFzVXNlcldpdGhFbWFpbClcbiAgICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAgICAgICAuanNvbih7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgRW1haWwgYWxyZWFkeSBleGlzdHNgXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICByZXR1cm4gVXNlcnNTZXJ2aWNlLmhhc2hQYXNzd29yZChwYXNzd29yZClcbiAgICAgICAgICAudGhlbigoaGFzaGVkUGFzc3dvcmQpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgbmV3VXNlciA9IHtcbiAgICAgICAgICAgICAgICAgIHJvbGU6ICdFbmQtVXNlcicsXG4gICAgICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgIGRhdGVfY3JlYXRlZDogJ25vdygpJyxcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiBVc2Vyc1NlcnZpY2UuaW5zZXJ0VXNlcihuZXdVc2VyKVxuICAgICAgICAgICAgICAudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgcmVzXG4gICAgICAgICAgICAgICAgICAgICAgLnN0YXR1cygyMDEpXG4gICAgICAgICAgICAgICAgICAgICAgLmxvY2F0aW9uKHBhdGgucG9zaXguam9pbihyZXEub3JpZ2luYWxVcmwsIGAvJHsgdXNlci51c2VyX2lkIH1gKSlcbiAgICAgICAgICAgICAgICAgICAgICAuanNvbihVc2Vyc1NlcnZpY2Uuc2VyaWFsaXplVXNlcih1c2VyKSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2gobmV4dCk7XG4gICAgfSk7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBVc2Vyc1JvdXRlcjtcbiJdfQ==
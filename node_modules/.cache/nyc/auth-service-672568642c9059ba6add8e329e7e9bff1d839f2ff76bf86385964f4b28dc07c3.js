function cov_u1bcb48k4(){var path="/Users/nickfarni/WebstormProjects/truth-checker-api/src/auth/auth-service.js";var hash="5c0c9a0cf32633ea84b0e202e85cccc03f084bd6";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/nickfarni/WebstormProjects/truth-checker-api/src/auth/auth-service.js",statementMap:{"0":{start:{line:2,column:15},end:{line:2,column:35}},"1":{start:{line:3,column:15},end:{line:3,column:45}},"2":{start:{line:6,column:15},end:{line:6,column:34}},"3":{start:{line:7,column:12},end:{line:7,column:35}},"4":{start:{line:9,column:20},end:{line:51,column:1}},"5":{start:{line:12,column:8},end:{line:14,column:10}},"6":{start:{line:18,column:8},end:{line:27,column:10}},"7":{start:{line:31,column:8},end:{line:33,column:20}},"8":{start:{line:37,column:8},end:{line:40,column:23}},"9":{start:{line:44,column:8},end:{line:48,column:10}},"10":{start:{line:53,column:0},end:{line:53,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:11,column:22},end:{line:11,column:23}},loc:{start:{line:11,column:42},end:{line:15,column:5}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:15},end:{line:17,column:16}},loc:{start:{line:17,column:37},end:{line:28,column:5}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:22},end:{line:30,column:23}},loc:{start:{line:30,column:33},end:{line:34,column:5}},line:30},"3":{name:"(anonymous_3)",decl:{start:{line:36,column:21},end:{line:36,column:22}},loc:{start:{line:36,column:32},end:{line:41,column:5}},line:36},"4":{name:"(anonymous_4)",decl:{start:{line:43,column:15},end:{line:43,column:16}},loc:{start:{line:43,column:26},end:{line:49,column:5}},line:43}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5c0c9a0cf32633ea84b0e202e85cccc03f084bd6"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_u1bcb48k4=function(){return actualCoverage;};}return actualCoverage;}cov_u1bcb48k4();// Authentication service
const config=(cov_u1bcb48k4().s[0]++,require('../config'));const{db}=(cov_u1bcb48k4().s[1]++,require('../database/connect'));// utils
const bcrypt=(cov_u1bcb48k4().s[2]++,require('bcryptjs'));const jwt=(cov_u1bcb48k4().s[3]++,require('jsonwebtoken'));const AuthService=(cov_u1bcb48k4().s[4]++,{comparePasswords:(password,hash)=>{cov_u1bcb48k4().f[0]++;cov_u1bcb48k4().s[5]++;return bcrypt.compare(password,hash);},createJwt:(subject,payload)=>{cov_u1bcb48k4().f[1]++;cov_u1bcb48k4().s[6]++;return jwt.sign(payload,config.JWT_SECRET,{subject,algorithm:'HS256'});},getUserWithEmail:email=>{cov_u1bcb48k4().f[2]++;cov_u1bcb48k4().s[7]++;return db('users').where({email}).first();},parseBasicToken:token=>{cov_u1bcb48k4().f[3]++;cov_u1bcb48k4().s[8]++;return Buffer.from(token,'base64').toString().split(':');},verifyJwt:token=>{cov_u1bcb48k4().f[4]++;cov_u1bcb48k4().s[9]++;return jwt.verify(token,config.JWT_SECRET,{algorithms:['HS256']});}});cov_u1bcb48k4().s[10]++;module.exports=AuthService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtc2VydmljZS5qcyJdLCJuYW1lcyI6WyJjb25maWciLCJyZXF1aXJlIiwiZGIiLCJiY3J5cHQiLCJqd3QiLCJBdXRoU2VydmljZSIsImNvbXBhcmVQYXNzd29yZHMiLCJwYXNzd29yZCIsImhhc2giLCJjb21wYXJlIiwiY3JlYXRlSnd0Iiwic3ViamVjdCIsInBheWxvYWQiLCJzaWduIiwiSldUX1NFQ1JFVCIsImFsZ29yaXRobSIsImdldFVzZXJXaXRoRW1haWwiLCJlbWFpbCIsIndoZXJlIiwiZmlyc3QiLCJwYXJzZUJhc2ljVG9rZW4iLCJ0b2tlbiIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsInNwbGl0IiwidmVyaWZ5Snd0IiwidmVyaWZ5IiwiYWxnb3JpdGhtcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI0aEVBZVk7eUZBZlo7QUFDQSxLQUFNQSxDQUFBQSxNQUFNLHlCQUFHQyxPQUFPLENBQUMsV0FBRCxDQUFWLENBQVosQ0FDQSxLQUFNLENBQUVDLEVBQUYsMEJBQVNELE9BQU8sQ0FBQyxxQkFBRCxDQUFoQixDQUFOLENBRUE7QUFDQSxLQUFNRSxDQUFBQSxNQUFNLHlCQUFHRixPQUFPLENBQUMsVUFBRCxDQUFWLENBQVosQ0FDQSxLQUFNRyxDQUFBQSxHQUFHLHlCQUFHSCxPQUFPLENBQUMsY0FBRCxDQUFWLENBQVQsQ0FFQSxLQUFNSSxDQUFBQSxXQUFXLHlCQUFHLENBRWhCQyxnQkFBZ0IsQ0FBRSxDQUFDQyxRQUFELENBQVdDLElBQVgsR0FBb0IsK0NBQ2xDLE1BQ0lMLENBQUFBLE1BQU0sQ0FBQ00sT0FBUCxDQUFlRixRQUFmLENBQXlCQyxJQUF6QixDQURKLENBR0gsQ0FOZSxDQVFoQkUsU0FBUyxDQUFFLENBQUNDLE9BQUQsQ0FBVUMsT0FBVixHQUFzQiwrQ0FDN0IsTUFDSVIsQ0FBQUEsR0FBRyxDQUFDUyxJQUFKLENBQ0lELE9BREosQ0FFSVosTUFBTSxDQUFDYyxVQUZYLENBR0ksQ0FDSUgsT0FESixDQUVJSSxTQUFTLENBQUUsT0FGZixDQUhKLENBREosQ0FVSCxDQW5CZSxDQXFCaEJDLGdCQUFnQixDQUFHQyxLQUFELEVBQVcsK0NBQ3pCLE1BQU9mLENBQUFBLEVBQUUsQ0FBQyxPQUFELENBQUYsQ0FDRmdCLEtBREUsQ0FDSSxDQUFFRCxLQUFGLENBREosRUFFRkUsS0FGRSxFQUFQLENBR0gsQ0F6QmUsQ0EyQmhCQyxlQUFlLENBQUdDLEtBQUQsRUFBVywrQ0FDeEIsTUFBT0MsQ0FBQUEsTUFBTSxDQUNSQyxJQURFLENBQ0dGLEtBREgsQ0FDVSxRQURWLEVBRUZHLFFBRkUsR0FHRkMsS0FIRSxDQUdJLEdBSEosQ0FBUCxDQUlILENBaENlLENBa0NoQkMsU0FBUyxDQUFHTCxLQUFELEVBQVcsK0NBQ2xCLE1BQU9qQixDQUFBQSxHQUFHLENBQUN1QixNQUFKLENBQVdOLEtBQVgsQ0FBa0JyQixNQUFNLENBQUNjLFVBQXpCLENBQ0gsQ0FDSWMsVUFBVSxDQUFFLENBQUMsT0FBRCxDQURoQixDQURHLENBQVAsQ0FLSCxDQXhDZSxDQUFILENBQWpCLEMsd0JBNENBQyxNQUFNLENBQUNDLE9BQVAsQ0FBaUJ6QixXQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8vIEF1dGhlbnRpY2F0aW9uIHNlcnZpY2VcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xuY29uc3QgeyBkYiB9ID0gcmVxdWlyZSgnLi4vZGF0YWJhc2UvY29ubmVjdCcpO1xuXG4vLyB1dGlsc1xuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuXG5jb25zdCBBdXRoU2VydmljZSA9IHtcblxuICAgIGNvbXBhcmVQYXNzd29yZHM6IChwYXNzd29yZCwgaGFzaCkgPT4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIGhhc2gpXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIGNyZWF0ZUp3dDogKHN1YmplY3QsIHBheWxvYWQpID0+IHsgXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBqd3Quc2lnbihcbiAgICAgICAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgICAgICAgIGNvbmZpZy5KV1RfU0VDUkVULFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdCxcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtOiAnSFMyNTYnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH0sXG5cbiAgICBnZXRVc2VyV2l0aEVtYWlsOiAoZW1haWwpID0+IHtcbiAgICAgICAgcmV0dXJuIGRiKCd1c2VycycpXG4gICAgICAgICAgICAud2hlcmUoeyBlbWFpbCB9KVxuICAgICAgICAgICAgLmZpcnN0KClcbiAgICB9LFxuXG4gICAgcGFyc2VCYXNpY1Rva2VuOiAodG9rZW4pID0+IHtcbiAgICAgICAgcmV0dXJuIEJ1ZmZlclxuICAgICAgICAgICAgLmZyb20odG9rZW4sICdiYXNlNjQnKVxuICAgICAgICAgICAgLnRvU3RyaW5nKClcbiAgICAgICAgICAgIC5zcGxpdCgnOicpXG4gICAgfSxcblxuICAgIHZlcmlmeUp3dDogKHRva2VuKSA9PiB7XG4gICAgICAgIHJldHVybiBqd3QudmVyaWZ5KHRva2VuLCBjb25maWcuSldUX1NFQ1JFVCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhbGdvcml0aG1zOiBbJ0hTMjU2J11cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXV0aFNlcnZpY2U7Il19